This is an excellent, detailed plan for a modern web application\!

As a single-file generator, I will combine all the logic and views into a single `index.html` file using **JavaScript** to handle the dynamic routing, content rendering, and state management (like the history and sidebar). This method satisfies the requirement for a unified look and feel, shared navigation, and persistent data storage across "pages" without needing multiple physical `.html` files.

The design incorporates **Glassmorphism**, a shared **Bubble background**, and a functional **History** feature.

Here is the complete, self-contained `index.html` file:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Converter Calculator App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* * Custom CSS for the Bubble Background and Glassmorphism Effect
         * Note: Since a physical 'bubble.png' isn't available, 
         * we'll simulate a dynamic, abstract bubble background 
         * with soft gradients, which is a common modern technique.
         */
        body {
            /* Fallback background color */
            background-color: #0b1a2e; 
            /* Simulate a gentle, deep blue/purple bubble pattern */
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(100, 160, 255, 0.4) 0%, transparent 40%),
                radial-gradient(circle at 80% 90%, rgba(180, 100, 255, 0.4) 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, rgba(50, 200, 255, 0.2) 0%, transparent 50%);
            background-size: cover;
            background-attachment: fixed;
            min-height: 100vh;
        }

        .glass-box {
            /* The core Glassmorphism effect */
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Styling for the interactive calculator buttons */
        .calc-btn {
            @apply bg-white/10 hover:bg-white/30 text-white font-bold py-4 rounded-xl transition duration-200 ease-in-out;
        }

        .calc-operator {
            @apply bg-blue-500/50 hover:bg-blue-600/70 text-white py-4 rounded-xl transition duration-200 ease-in-out;
        }

        .calc-equals {
            @apply bg-gradient-to-r from-teal-500 to-blue-500 hover:from-teal-600 hover:to-blue-600 text-white py-4 rounded-xl transition duration-200 ease-in-out;
        }
    </style>
</head>
<body class="text-white">

    <div id="app" class="flex flex-col min-h-screen">
        </div>

    <script>
        // === STATE MANAGEMENT ===
        let currentPage = 'home';
        let isSidebarOpen = false;
        let history = []; // Stores calculation history: [{ expression: '1+1', result: 2, timestamp: '...' }]

        // === UTILITY FUNCTIONS ===

        // Function to load history (dummy for simplicity, would use localStorage/API in production)
        function loadHistory() {
            try {
                history = JSON.parse(localStorage.getItem('calcHistory') || '[]');
            } catch (e) {
                history = [];
            }
        }

        // Function to save history (dummy for simplicity)
        function saveHistory(expression, result) {
            history.unshift({
                expression,
                result,
                timestamp: new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })
            });
            // Keep history list short for display
            history = history.slice(0, 10); 
            localStorage.setItem('calcHistory', JSON.stringify(history));
        }

        // === UI COMPONENTS (Shared Layout) ===

        function toggleSidebar() {
            isSidebarOpen = !isSidebarOpen;
            renderApp();
        }

        function navigateTo(page) {
            currentPage = page;
            isSidebarOpen = false; // Close sidebar upon navigation
            renderApp();
        }

        // Renders the main header bar with the menu button and title
        function renderHeader() {
            return `
                <header class="p-4 flex justify-between items-center glass-box w-full shadow-lg fixed top-0 z-20">
                    <button onclick="toggleSidebar()" class="text-3xl p-2 rounded hover:bg-white/20 transition duration-150">
                        â˜°
                    </button>
                    <h1 class="text-xl font-extrabold tracking-wider">
                        ${currentPage.charAt(0).toUpperCase() + currentPage.slice(1)} ${currentPage === 'home' ? 'Calculator' : 'Tool'}
                    </h1>
                    <button onclick="navigateTo('home')" class="bg-white/10 hover:bg-white/30 text-sm font-semibold px-4 py-2 rounded-full transition duration-150">
                        Exit / Home
                    </button>
                </header>
            `;
        }

        // Renders the sliding sidebar menu
        function renderSidebar() {
            const links = [
                { name: 'Home Calculator', page: 'home', icon: 'âŒ‚' },
                { name: 'Tip Calculator', page: 'tip', icon: 'ðŸ’µ' },
                { name: 'BMI Calculator', page: 'bmi', icon: 'ðŸ§' },
                { name: 'Temperature Converter', page: 'temp', icon: 'ðŸŒ¡ï¸' },
                { name: 'Unit Converter', page: 'unit', icon: 'ðŸ“' }
            ];

            const linkMarkup = links.map(link => `
                <a href="#" onclick="navigateTo('${link.page}')" 
                   class="flex items-center p-3 text-lg rounded-lg transition duration-150 
                          ${currentPage === link.page ? 'bg-blue-600/70' : 'hover:bg-white/20'}">
                    <span class="mr-3">${link.icon}</span> ${link.name}
                </a>
            `).join('');

            return `
                <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-30 transition-opacity duration-300 ${isSidebarOpen ? 'opacity-100 visible' : 'opacity-0 invisible'}" onclick="toggleSidebar()"></div>
                <nav id="sidebar" class="fixed top-0 left-0 h-full w-64 p-6 glass-box z-40 transform transition-transform duration-300 ease-in-out ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'}">
                    <h2 class="text-2xl font-bold mb-6 border-b border-white/30 pb-2">Menu</h2>
                    <div class="space-y-3">
                        ${linkMarkup}
                    </div>
                </nav>
            `;
        }

        // Renders the central content container
        function renderMainContent() {
            let content = '';
            switch (currentPage) {
                case 'home':
                    content = renderHomeCalculator();
                    break;
                case 'bmi':
                    content = renderBMICalculator();
                    break;
                case 'tip':
                    content = renderTipCalculator();
                    break;
                case 'temp':
                    content = renderTempConverter();
                    break;
                case 'unit':
                    content = renderUnitConverter();
                    break;
                default:
                    content = renderHomeCalculator();
            }

            // Margin-top is for the fixed header
            return `
                <main class="flex-grow p-6 pt-20 flex justify-center items-center">
                    <div class="glass-box p-6 md:p-10 rounded-3xl w-full max-w-lg shadow-2xl">
                        ${content}
                    </div>
                </main>
            `;
        }


        // === PAGE VIEW FUNCTIONS ===

        // 1. HOME CALCULATOR & HISTORY
        function renderHomeCalculator() {
            setTimeout(attachCalculatorLogic, 0); // Ensure logic runs after HTML is injected

            const historyMarkup = history.map(item => `
                <div class="flex justify-between items-center text-sm p-2 rounded hover:bg-white/10 transition">
                    <span class="font-mono text-white/70">${item.expression}</span>
                    <span class="font-semibold text-teal-400">${item.result}</span>
                </div>
            `).join('');

            return `
                <h2 class="text-3xl font-bold mb-4">Basic Calculator</h2>
                <div class="space-y-4">
                    <div class="glass-box p-4 rounded-xl text-right overflow-hidden shadow-inner">
                        <div id="calc-history-display" class="text-sm text-white/60 min-h-[1.5em]"></div>
                        <div id="calc-main-display" class="text-5xl font-light min-h-[1em]">0</div>
                    </div>
                    
                    <div class="grid grid-cols-4 gap-3">
                        <button class="calc-operator col-span-2 text-xl" onclick="clearDisplay('AC')">AC</button>
                        <button class="calc-operator text-xl" onclick="clearDisplay('DEL')">DEL</button>
                        <button class="calc-operator text-2xl" data-value="/" >Ã·</button>
                        
                        <button class="calc-btn text-2xl" data-value="7">7</button>
                        <button class="calc-btn text-2xl" data-value="8">8</button>
                        <button class="calc-btn text-2xl" data-value="9">9</button>
                        <button class="calc-operator text-2xl" data-value="*">Ã—</button>

                        <button class="calc-btn text-2xl" data-value="4">4</button>
                        <button class="calc-btn text-2xl" data-value="5">5</button>
                        <button class="calc-btn text-2xl" data-value="6">6</button>
                        <button class="calc-operator text-2xl" data-value="-">âˆ’</button>

                        <button class="calc-btn text-2xl" data-value="1">1</button>
                        <button class="calc-btn text-2xl" data-value="2">2</button>
                        <button class="calc-btn text-2xl" data-value="3">3</button>
                        <button class="calc-operator text-2xl" data-value="+">+</button>

                        <button class="calc-btn text-2xl col-span-2" data-value="0">0</button>
                        <button class="calc-btn text-2xl" data-value=".">.</button>
                        <button class="calc-equals text-2xl" onclick="calculateResult()">=</button>
                    </div>

                    <div class="mt-6 pt-4 border-t border-white/30">
                        <h3 class="text-xl font-semibold mb-2 flex justify-between items-center">
                            History ðŸ“œ <button onclick="history=[] ; saveHistory(); renderApp()" class="text-xs text-red-400 hover:text-red-300">Clear</button>
                        </h3>
                        <div id="history-list" class="space-y-1 max-h-40 overflow-y-auto pr-2">
                            ${history.length > 0 ? historyMarkup : '<p class="text-white/50 text-sm">No calculations yet.</p>'}
                        </div>
                    </div>
                </div>
            `;
        }

        // Calculator Logic
        let currentInput = '';
        let fullExpression = '';
        let isResultDisplayed = false;

        function updateDisplay() {
            document.getElementById('calc-main-display').innerText = currentInput || '0';
            document.getElementById('calc-history-display').innerText = fullExpression;
        }

        function appendValue(value) {
            if (isResultDisplayed) {
                currentInput = '';
                fullExpression = '';
                isResultDisplayed = false;
            }

            if (/[+\-*/]/.test(value)) {
                // Operator logic
                if (currentInput === '' && fullExpression === '') return; // Cannot start with operator
                if (currentInput === '') {
                    // Replace the last operator if one is already present
                    fullExpression = fullExpression.slice(0, -1) + value;
                } else {
                    fullExpression += currentInput + value;
                    currentInput = '';
                }
            } else if (value === '.') {
                if (!currentInput.includes('.')) {
                    currentInput += currentInput === '' ? '0.' : value;
                }
            } else {
                // Number logic
                currentInput += value;
            }
            updateDisplay();
        }

        function clearDisplay(type) {
            if (type === 'AC') {
                currentInput = '';
                fullExpression = '';
            } else if (type === 'DEL') {
                if (currentInput !== '') {
                    currentInput = currentInput.slice(0, -1);
                } else if (fullExpression !== '') {
                    // Backspace into the full expression to retrieve the last number
                    const lastOperatorIndex = fullExpression.search(/[+\-*/](?=[^+\-*/]*$)/);
                    if (lastOperatorIndex !== -1) {
                        currentInput = fullExpression.substring(lastOperatorIndex + 1);
                        fullExpression = fullExpression.substring(0, lastOperatorIndex + 1);
                    }
                }
            }
            isResultDisplayed = false;
            updateDisplay();
        }

        function calculateResult() {
            if (currentInput === '' && fullExpression === '') return;

            // Finalize expression
            let finalExpression = fullExpression + currentInput;

            // Remove trailing operators
            finalExpression = finalExpression.replace(/[+\-*/]$/, '');

            try {
                // Use a safe function (like eval) to calculate the result
                const result = Function('return ' + finalExpression.replace(/Ã—/g, '*').replace(/Ã·/g, '/'))();
                
                // Format the result
                const formattedResult = parseFloat(result.toFixed(8)).toString();

                // Save to history
                saveHistory(finalExpression.replace(/\*/g, 'Ã—').replace(/\//g, 'Ã·'), formattedResult);
                
                // Update state for next calculation
                fullExpression = '';
                currentInput = formattedResult;
                isResultDisplayed = true;

            } catch (error) {
                currentInput = 'Error';
                fullExpression = '';
                isResultDisplayed = true;
                console.error("Calculation Error:", error);
            }
            renderApp(); // Re-render to update the History list
            updateDisplay();
        }

        function attachCalculatorLogic() {
            // Attach click listeners to all data-value buttons
            const buttons = document.querySelectorAll('#app button[data-value]');
            buttons.forEach(button => {
                button.onclick = () => appendValue(button.getAttribute('data-value'));
            });
            updateDisplay(); // Initialize display state
        }


        // 2. BMI CALCULATOR
        function renderBMICalculator() {
             setTimeout(attachBMILogic, 0);

            return `
                <h2 class="text-3xl font-bold mb-6">BMI Calculator</h2>
                <div class="space-y-4">
                    <div>
                        <label for="bmi-weight" class="block text-sm font-medium mb-1">Weight (kg)</label>
                        <input type="number" id="bmi-weight" placeholder="Enter weight in kilograms" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white" min="1">
                    </div>
                    <div>
                        <label for="bmi-height" class="block text-sm font-medium mb-1">Height (cm)</label>
                        <input type="number" id="bmi-height" placeholder="Enter height in centimeters" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white" min="1">
                    </div>
                    <button id="calculate-bmi" class="w-full calc-equals text-xl mt-4">Calculate BMI</button>
                    
                    <div id="bmi-result-box" class="mt-6 p-4 rounded-xl text-center border-t border-white/30 bg-white/5 hidden">
                        <p class="text-sm">Your BMI is:</p>
                        <p id="bmi-value" class="text-4xl font-bold text-teal-400">0.0</p>
                        <p id="bmi-status" class="text-lg font-semibold mt-2"></p>
                    </div>
                </div>
            `;
        }

        function attachBMILogic() {
            document.getElementById('calculate-bmi').onclick = () => {
                const weight = parseFloat(document.getElementById('bmi-weight').value);
                const height = parseFloat(document.getElementById('bmi-height').value);
                const resultBox = document.getElementById('bmi-result-box');
                const bmiValueDisplay = document.getElementById('bmi-value');
                const bmiStatusDisplay = document.getElementById('bmi-status');

                if (isNaN(weight) || isNaN(height) || weight <= 0 || height <= 0) {
                    alert('Please enter valid, positive values for weight and height.');
                    resultBox.classList.add('hidden');
                    return;
                }

                // Formula: weight (kg) / [height (m)]^2
                const heightInMeters = height / 100;
                const bmi = weight / (heightInMeters * heightInMeters);
                const roundedBmi = bmi.toFixed(1);

                let status = '';
                let colorClass = '';

                if (bmi < 18.5) {
                    status = 'Underweight ðŸ˜ž';
                    colorClass = 'text-yellow-400';
                } else if (bmi >= 18.5 && bmi < 24.9) {
                    status = 'Normal Weight ðŸ‘';
                    colorClass = 'text-green-400';
                } else if (bmi >= 25 && bmi < 29.9) {
                    status = 'Overweight âš ï¸';
                    colorClass = 'text-orange-400';
                } else {
                    status = 'Obese ðŸš¨';
                    colorClass = 'text-red-400';
                }

                bmiValueDisplay.innerText = roundedBmi;
                bmiStatusDisplay.innerText = status;
                bmiStatusDisplay.className = `text-lg font-semibold mt-2 ${colorClass}`;
                resultBox.classList.remove('hidden');
            };
        }

        // 3. TIP CALCULATOR
        function renderTipCalculator() {
            setTimeout(attachTipLogic, 0);
            return `
                <h2 class="text-3xl font-bold mb-6">Tip Calculator</h2>
                <div class="space-y-4">
                    <div>
                        <label for="bill-amount" class="block text-sm font-medium mb-1">Bill Amount ($)</label>
                        <input type="number" id="bill-amount" placeholder="e.g., 50.00" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white" min="0" step="0.01">
                    </div>
                    <div>
                        <label for="tip-percent" class="block text-sm font-medium mb-1">Tip Percentage (%)</label>
                        <input type="range" id="tip-percent" min="0" max="30" value="15" class="w-full h-2 bg-white/30 rounded-lg appearance-none cursor-pointer">
                        <p class="text-center mt-2 text-xl font-mono"><span id="tip-display">15</span>%</p>
                    </div>
                    <button id="calculate-tip" class="w-full calc-equals text-xl mt-4">Calculate Total</button>
                    
                    <div id="tip-result-box" class="mt-6 p-4 rounded-xl text-center border-t border-white/30 bg-white/5 hidden">
                        <p class="text-sm">Tip Amount:</p>
                        <p id="tip-amount" class="text-3xl font-bold text-teal-400">$0.00</p>
                        <p class="text-sm mt-3">Total Bill:</p>
                        <p id="total-bill" class="text-4xl font-extrabold text-blue-400">$0.00</p>
                    </div>
                </div>
            `;
        }

        function attachTipLogic() {
            const billInput = document.getElementById('bill-amount');
            const tipRange = document.getElementById('tip-percent');
            const tipDisplay = document.getElementById('tip-display');
            const calcButton = document.getElementById('calculate-tip');
            const resultBox = document.getElementById('tip-result-box');
            const tipAmountDisplay = document.getElementById('tip-amount');
            const totalBillDisplay = document.getElementById('total-bill');

            const calculate = () => {
                const bill = parseFloat(billInput.value);
                const tipPercent = parseInt(tipRange.value);

                tipDisplay.innerText = tipPercent;

                if (isNaN(bill) || bill < 0) {
                    resultBox.classList.add('hidden');
                    return;
                }

                const tip = bill * (tipPercent / 100);
                const total = bill + tip;

                tipAmountDisplay.innerText = `$${tip.toFixed(2)}`;
                totalBillDisplay.innerText = `$${total.toFixed(2)}`;
                resultBox.classList.remove('hidden');
            };

            // Calculate on input change for real-time update
            billInput.oninput = calculate;
            tipRange.oninput = calculate;
            calcButton.onclick = calculate;
        }

        // 4. TEMPERATURE CONVERTER
        function renderTempConverter() {
            setTimeout(attachTempLogic, 0);
            return `
                <h2 class="text-3xl font-bold mb-6">Temperature Converter</h2>
                <div class="space-y-4">
                    <div>
                        <label for="temp-input" class="block text-sm font-medium mb-1">Input Temperature</label>
                        <input type="number" id="temp-input" placeholder="Enter value" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white">
                    </div>
                    <div>
                        <label for="temp-unit" class="block text-sm font-medium mb-1">Convert From</label>
                        <select id="temp-unit" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white appearance-none cursor-pointer">
                            <option value="C" class="bg-gray-800">Celsius (Â°C)</option>
                            <option value="F" class="bg-gray-800">Fahrenheit (Â°F)</option>
                        </select>
                    </div>
                    <button id="convert-temp" class="w-full calc-equals text-xl mt-4">Convert</button>
                    
                    <div id="temp-result-box" class="mt-6 p-4 rounded-xl text-center border-t border-white/30 bg-white/5 hidden">
                        <p class="text-sm">Converted Result:</p>
                        <p id="temp-result" class="text-4xl font-bold text-teal-400">0.0</p>
                        <p id="temp-unit-display" class="text-lg font-semibold mt-2"></p>
                    </div>
                </div>
            `;
        }

        function attachTempLogic() {
            const input = document.getElementById('temp-input');
            const unitSelect = document.getElementById('temp-unit');
            const convertButton = document.getElementById('convert-temp');
            const resultBox = document.getElementById('temp-result-box');
            const resultDisplay = document.getElementById('temp-result');
            const unitDisplay = document.getElementById('temp-unit-display');

            convertButton.onclick = () => {
                const value = parseFloat(input.value);
                const fromUnit = unitSelect.value;
                let result = 0;
                let toUnit = '';

                if (isNaN(value)) {
                    alert('Please enter a valid number.');
                    resultBox.classList.add('hidden');
                    return;
                }

                if (fromUnit === 'C') {
                    // C to F: (C * 9/5) + 32
                    result = (value * 9/5) + 32;
                    toUnit = 'Fahrenheit (Â°F)';
                } else if (fromUnit === 'F') {
                    // F to C: (F - 32) * 5/9
                    result = (value - 32) * 5/9;
                    toUnit = 'Celsius (Â°C)';
                }

                resultDisplay.innerText = result.toFixed(2);
                unitDisplay.innerText = toUnit;
                resultBox.classList.remove('hidden');
            };
        }
        
        // 5. UNIT CONVERTER (Simplified for Length/Weight/Temp)
        function renderUnitConverter() {
            setTimeout(attachUnitLogic, 0);
            
            const conversionTypes = `
                <option value="length" class="bg-gray-800">Length</option>
                <option value="weight" class="bg-gray-800">Weight</option>
                <option value="temperature" class="bg-gray-800">Temperature</option>
            `;

            return `
                <h2 class="text-3xl font-bold mb-6">Unit Converter</h2>
                <div class="space-y-4">
                    <div>
                        <label for="unit-type" class="block text-sm font-medium mb-1">Conversion Type</label>
                        <select id="unit-type" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white appearance-none cursor-pointer">
                            ${conversionTypes}
                        </select>
                    </div>
                    <div>
                        <label for="unit-input" class="block text-sm font-medium mb-1">Value</label>
                        <input type="number" id="unit-input" placeholder="Enter value" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white">
                    </div>
                    
                    <div id="unit-selectors" class="flex space-x-2">
                        <div class="flex-1">
                            <label for="unit-from" class="block text-sm font-medium mb-1">From Unit</label>
                            <select id="unit-from" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white appearance-none cursor-pointer"></select>
                        </div>
                        <div class="flex-1">
                            <label for="unit-to" class="block text-sm font-medium mb-1">To Unit</label>
                            <select id="unit-to" class="w-full p-3 rounded-xl bg-white/10 border border-white/30 focus:border-blue-400 focus:outline-none text-white appearance-none cursor-pointer"></select>
                        </div>
                    </div>

                    <button id="convert-unit" class="w-full calc-equals text-xl mt-4">Convert</button>
                    
                    <div id="unit-result-box" class="mt-6 p-4 rounded-xl text-center border-t border-white/30 bg-white/5 hidden">
                        <p class="text-sm">Converted Result:</p>
                        <p id="unit-result" class="text-4xl font-bold text-teal-400">0.0</p>
                        <p id="unit-result-display" class="text-lg font-semibold mt-2"></p>
                    </div>
                </div>
            `;
        }

        function attachUnitLogic() {
            const typeSelect = document.getElementById('unit-type');
            const input = document.getElementById('unit-input');
            const fromSelect = document.getElementById('unit-from');
            const toSelect = document.getElementById('unit-to');
            const convertButton = document.getElementById('convert-unit');
            const resultBox = document.getElementById('unit-result-box');
            const resultDisplay = document.getElementById('unit-result');
            const resultText = document.getElementById('unit-result-display');

            const unitsMap = {
                length: [
                    { value: 'm', name: 'Meters' },
                    { value: 'km', name: 'Kilometers' },
                    { value: 'ft', name: 'Feet' },
                    { value: 'mi', name: 'Miles' }
                ],
                weight: [
                    { value: 'kg', name: 'Kilograms' },
                    { value: 'lb', name: 'Pounds' },
                    { value: 'g', name: 'Grams' },
                    { value: 'oz', name: 'Ounces' }
                ],
                temperature: [
                    { value: 'C', name: 'Celsius' },
                    { value: 'F', name: 'Fahrenheit' },
                    { value: 'K', name: 'Kelvin' }
                ]
            };

            const conversionFactors = {
                // To Base Unit (e.g., Meter for Length)
                m: 1, km: 1000, ft: 0.3048, mi: 1609.34,
                kg: 1, lb: 0.453592, g: 0.001, oz: 0.0283495,
                // Temperature is handled by functions below, not simple multiplication
            };

            function populateUnitSelectors(type) {
                const options = unitsMap[type].map(u => 
                    `<option value="${u.value}" class="bg-gray-800">${u.name}</option>`
                ).join('');
                fromSelect.innerHTML = options;
                toSelect.innerHTML = options;
            }

            function convert(value, fromUnit, toUnit, type) {
                if (type === 'temperature') {
                    // Base is Kelvin (K)
                    let baseK = 0;
                    if (fromUnit === 'C') baseK = value + 273.15;
                    else if (fromUnit === 'F') baseK = (value - 32) * 5/9 + 273.15;
                    else if (fromUnit === 'K') baseK = value;

                    if (toUnit === 'C') return baseK - 273.15;
                    else if (toUnit === 'F') return (baseK - 273.15) * 9/5 + 32;
                    else if (toUnit === 'K') return baseK;
                    return value; // Should not happen

                } else {
                    // Base Unit (e.g., Meter, Kilogram) conversion
                    const valueInBase = value * conversionFactors[fromUnit];
                    return valueInBase / conversionFactors[toUnit];
                }
            }

            // Initial load
            populateUnitSelectors(typeSelect.value);
            typeSelect.onchange = () => populateUnitSelectors(typeSelect.value);

            convertButton.onclick = () => {
                const value = parseFloat(input.value);
                const type = typeSelect.value;
                const fromUnit = fromSelect.value;
                const toUnit = toSelect.value;

                if (isNaN(value)) {
                    alert('Please enter a valid number.');
                    resultBox.classList.add('hidden');
                    return;
                }
                if (fromUnit === toUnit) {
                    resultDisplay.innerText = value.toFixed(2);
                    resultText.innerText = `Result is the same unit.`;
                    resultBox.classList.remove('hidden');
                    return;
                }

                const result = convert(value, fromUnit, toUnit, type);
                
                const fromName = unitsMap[type].find(u => u.value === fromUnit).name;
                const toName = unitsMap[type].find(u => u.value === toUnit).name;

                resultDisplay.innerText = result.toFixed(4);
                resultText.innerText = `${fromName} to ${toName}`;
                resultBox.classList.remove('hidden');
            };
        }

        // === MAIN RENDER FUNCTION ===
        function renderApp() {
            // Load history state before rendering
            loadHistory(); 

            const app = document.getElementById('app');
            app.innerHTML = `
                ${renderSidebar()}
                ${renderHeader()}
                ${renderMainContent()}
            `;
        }

        // Initialize the app on page load
        document.addEventListener('DOMContentLoaded', renderApp);

    </script>
</body>
</html>
```
